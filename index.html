<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Солнечная микрогенерация — комплекты и подключение | АО «Россети Кубань»</title>

<!-- Шрифты -->
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&family=Montserrat:wght@700;800&display=swap" rel="stylesheet">

<!-- EmailJS SDK -->
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
<script type="text/javascript">
  (function(){
    // Вставьте ваш Public Key EmailJS
    emailjs.init("YOUR_PUBLIC_KEY");
  })();
</script>

<style>
  /* ===== Корпоративные токены (в стиле rosseti-kuban.ru) ===== */
  :root{
    /* Фирменный синий (Pantone 301C) и оттенки */
    --rs-blue:#004B87;
    --rs-blue-600:#003B6C;         /* темнее для hover/фокуса */
    --rs-blue-300:#2E6FA3;         /* светлее для бордеров/пилюль */
    --rs-accent:#00AEEF;           /* голубой-акцент (служебно, умеренно) */

    /* Нейтрали */
    --ink:#1F2A37;                 /* основной текст */
    --ink-soft:#334155;            /* подписи/вторичный */
    --muted:#667185;               /* muted */
    --bg:#F7F9FC;                  /* фон блоков/полос */
    --paper:#FFFFFF;               /* карточки/модали */
    --line:#E5EAF1;                /* границы */
    --line-strong:#D6DEE9;

    /* Состояния */
    --ok:#107C41;
    --warn:#B35C00;
    --bad:#B00020;

    /* Геометрия */
    --radius:12px;
    --radius-sm:10px;
    --radius-lg:16px;
    --shadow:0 4px 16px rgba(17, 24, 39, .06);
    --shadow-hover:0 8px 24px rgba(17, 24, 39, .10);
    --maxw:1200px;

    /* Анимация */
    --ease:cubic-bezier(.2,.8,.2,1);
  }

  *{box-sizing:border-box}
  html,body{margin:0;padding:0}
  html{scroll-behavior:smooth}
  body{
    font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial;
    color:var(--ink);
    background:#fff;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    overflow-x:hidden;
  }
  a{color:var(--rs-blue);text-decoration:none}
  a:hover{color:var(--rs-blue-600)}
  img{max-width:100%;display:block}

  /* Прогресс-индикатор */
  .scrollbar{
    position:fixed; top:0; left:0; height:3px; width:0%;
    background:var(--rs-blue);
    z-index:1100;
    transition:width .1s var(--ease);
  }

  /* ===== Верхняя служебная полоса (как на сайте) ===== */
  .topbar{
    background:var(--rs-blue);
    color:#fff;
    font-size:14px;
  }
  .topbar .wrap{
    max-width:var(--maxw); margin:0 auto; padding:8px 20px;
    display:flex; gap:16px; align-items:center; justify-content:space-between; flex-wrap:wrap;
  }
  .topbar a{color:#fff; opacity:.95}
  .topbar a:hover{opacity:1; text-decoration:underline}

  /* ===== Хедер ===== */
  header{
    position:sticky; top:0; z-index:1000;
    background:#fff;
    border-bottom:1px solid var(--line);
  }
  .nav{
    max-width:var(--maxw); margin:auto; padding:14px 20px;
    display:flex; align-items:center; justify-content:space-between; gap:16px;
  }
  .logo{display:flex; align-items:center; gap:12px}
  .mark{
    width:36px; height:36px; border-radius:50%;
    background:
      radial-gradient(circle at 50% 50%, #fff 34%, #fff 34%),
      conic-gradient(from 20deg, #fff 0 10deg, var(--rs-blue) 10deg 60deg, #fff 60deg 70deg, var(--rs-blue) 70deg 115deg, #fff 115deg 125deg, var(--rs-blue) 125deg 170deg, #fff 170deg 180deg, var(--rs-blue) 180deg 225deg, #fff 225deg 235deg, var(--rs-blue) 235deg 280deg, #fff 280deg 290deg, var(--rs-blue) 290deg 335deg, #fff 335deg 345deg, var(--rs-blue) 345deg 360deg);
    box-shadow:inset 0 0 0 3px var(--rs-blue), 0 1px 2px rgba(0,0,0,.06);
  }
  .brand{
    display:flex; flex-direction:column; line-height:1.05;
    font-weight:800; color:var(--ink);
  }
  .brand small{font-weight:600; color:var(--ink-soft)}

  .menu-toggle{
    display:none; width:36px; height:36px; background:transparent; border:none; cursor:pointer; position:relative;
  }
  .menu-toggle span{
    display:block; width:22px; height:2px; background:var(--rs-blue);
    position:absolute; left:50%; transform:translateX(-50%); transition:.3s;
  }
  .menu-toggle span:nth-child(1){top:10px}
  .menu-toggle span:nth-child(2){top:17px}
  .menu-toggle span:nth-child(3){top:24px}
  .menu-toggle.active span:nth-child(1){transform:translateX(-50%) rotate(45deg); top:17px}
  .menu-toggle.active span:nth-child(2){opacity:0}
  .menu-toggle.active span:nth-child(3){transform:translateX(-50%) rotate(-45deg); top:17px}

  .navlinks{
    display:flex; gap:20px; align-items:center; flex-wrap:wrap;
  }
  .navlinks a{
    color:var(--ink); font-weight:700; letter-spacing:.2px; text-transform:none; position:relative; padding:6px 0;
  }
  .navlinks a::after{
    content:''; position:absolute; left:0; right:0; bottom:-10px; height:2px;
    background:var(--rs-blue); transform:scaleX(0); transition:transform .25s var(--ease);
  }
  .navlinks a:hover::after{transform:scaleX(1)}

  .cta{
    padding:10px 18px; border-radius:8px; border:1px solid transparent;
    background:var(--rs-blue); color:#fff; font-weight:800;
    box-shadow:0 2px 6px rgba(0,0,0,.08);
    transition:all .25s var(--ease); display:inline-flex; align-items:center; gap:8px;
  }
  .cta:hover{background:var(--rs-blue-600); transform:translateY(-1px)}
  .ghost{
    padding:10px 16px; border-radius:8px; border:1px solid var(--line);
    background:#fff; font-weight:700; color:var(--ink); transition:all .25s var(--ease);
  }
  .ghost:hover{border-color:var(--rs-blue); color:var(--rs-blue); transform:translateY(-1px)}

  /* ===== Hero ===== */
  .hero{position:relative; border-bottom:1px solid var(--line)}
  .hero .wrap{
    max-width:var(--maxw); margin:auto; padding:42px 20px 28px;
    display:grid; grid-template-columns:1.15fr .85fr; gap:28px;
  }
  .eyebrow{
    display:inline-flex; align-items:center; gap:8px;
    background:#EAF2F9; color:var(--rs-blue);
    padding:6px 12px; border-radius:999px; font-weight:800; font-size:12px; letter-spacing:.35px; text-transform:uppercase;
  }
  h1{
    font-family:Montserrat,Inter; font-weight:800; line-height:1.05;
    font-size:clamp(30px,4.2vw,48px); margin:14px 0 10px; color:var(--ink);
  }
  .lead{
    font-size:clamp(16px,2vw,19px); color:var(--ink-soft); max-width:64ch; line-height:1.55;
  }
  .hero-cards{
    display:grid; grid-template-columns:repeat(3,1fr); gap:12px; margin-top:18px;
  }
  .stat{
    background:#fff; border:1px solid var(--line); border-radius:var(--radius);
    padding:16px; box-shadow:var(--shadow);
    display:flex; align-items:center; gap:12px; transition:box-shadow .25s var(--ease), transform .25s var(--ease);
  }
  .stat:hover{box-shadow:var(--shadow-hover); transform:translateY(-2px)}
  .stat .icon{font-size:24px}
  .stat strong{font-size:22px; color:var(--rs-blue)}
  .stat .label{font-size:12px; font-weight:700; color:var(--muted); text-transform:uppercase; letter-spacing:.5px}

  /* Иллюстрация — сдержанная */
  .illus{
    align-self:center; justify-self:center; width:min(480px,95%); aspect-ratio:1.15;
    background:#F5F8FC; border:1px solid var(--line); border-radius:16px; box-shadow:var(--shadow);
    position:relative; overflow:hidden;
  }
  .chip{position:absolute; background:#fff; border:1px solid var(--line); border-radius:14px; padding:8px 12px; box-shadow:var(--shadow); font-weight:800; color:var(--rs-blue); display:none}
  .solar-panel{
    position:absolute; left:50%; top:50%; transform:translate(-50%,-50%) perspective(700px) rotateX(22deg);
    width:200px; height:140px; background:linear-gradient(135deg,#1f4b7a,#275e94); border-radius:8px; box-shadow:0 18px 36px rgba(0,0,0,.18);
    display:grid; grid-template-columns:repeat(5,1fr); grid-template-rows:repeat(3,1fr); gap:2px; padding:8px;
  }
  .solar-cell{background:linear-gradient(135deg,#3c6a9b,#5f87af); border-radius:2px}

  .wave{display:none}

  /* ===== Секции ===== */
  section{max-width:var(--maxw); margin:0 auto; padding:54px 20px}
  h2{
    font-family:Montserrat,Inter; font-weight:800; color:var(--ink); margin:0 0 14px; font-size:clamp(24px,3.2vw,34px);
    position:relative; display:inline-block;
  }
  h2::after{
    content:''; position:absolute; bottom:-8px; left:0; width:64px; height:2px; background:var(--rs-blue);
  }
  .sub{color:var(--ink-soft); margin-top:-4px; margin-bottom:22px; font-size:16px; line-height:1.5}

  .grid{display:grid; gap:18px}
  .grid.cols-3{grid-template-columns:repeat(3,1fr)}
  .grid.cols-2{grid-template-columns:repeat(2,1fr)}

  .card{
    background:#fff; border:1px solid var(--line); border-radius:var(--radius);
    box-shadow:var(--shadow); padding:22px; transform:translateY(8px); opacity:0; transition:all .45s var(--ease); position:relative; overflow:hidden;
  }
  .card._in{transform:none; opacity:1}

  .benefit{display:flex; gap:14px; align-items:flex-start}
  .icon{
    width:44px; height:44px; border-radius:10px; display:grid; place-items:center; background:#F0F4FA; border:1px solid var(--line);
    flex:0 0 44px; font-size:22px; transition:transform .25s var(--ease);
  }
  .benefit:hover .icon{transform:translateY(-2px)}
  .benefit h3{margin:0 0 6px; font-size:18px; color:var(--rs-blue)}
  .benefit p{margin:0; color:var(--ink); opacity:.9; line-height:1.5}

  /* ===== Табы ===== */
  .tabs{
    display:flex; gap:6px; flex-wrap:wrap; margin:14px 0 20px; background:#F2F6FB; padding:6px; border-radius:999px; border:1px solid var(--line);
  }
  .tab{
    padding:10px 18px; border-radius:999px; border:none; background:transparent; font-weight:800; color:var(--ink); cursor:pointer; transition:all .2s var(--ease);
  }
  .tab:hover{color:var(--rs-blue)}
  .tab.active{background:#fff; color:var(--rs-blue); border:1px solid var(--rs-blue-300); box-shadow:0 2px 6px rgba(0,0,0,.06)}

  /* ===== Карточки комплектов ===== */
  .pack{position:relative; cursor:pointer}
  .pack:hover{transform:translateY(-4px); box-shadow:var(--shadow-hover)}
  .badge{
    display:inline-block; padding:6px 10px; border-radius:999px; background:var(--rs-blue); color:#fff; font-size:12px; font-weight:800; letter-spacing:.4px; margin-bottom:10px;
  }
  .title{font-size:19px; font-weight:800; color:var(--ink); margin-bottom:6px}
  .price{font-size:28px; font-weight:800; color:var(--rs-blue); margin:10px 0}
  .list{display:grid; gap:10px; margin:14px 0}
  .list li{display:flex; align-items:flex-start; gap:10px}
  .check{width:22px; height:22px; border-radius:6px; display:grid; place-items:center; flex:0 0 22px; background:#F0FFF7; border:1px solid #CBECD8; color:var(--ok); font-weight:800}

  /* ===== Калькулятор ===== */
  .calc{display:grid; grid-template-columns:1.2fr 1fr; gap:22px}
  .field{display:grid; gap:6px}
  .field label{font-weight:700; color:var(--ink); display:flex; align-items:center; gap:8px}
  .input,select{
    width:100%; padding:12px 14px; border-radius:10px; border:1px solid var(--line); background:#fff; font:inherit; transition:all .2s;
  }
  .input:hover,select:hover{border-color:var(--rs-blue-300)}
  .input:focus,select:focus{outline:none; border-color:var(--rs-blue); box-shadow:0 0 0 3px rgba(0,75,135,.15)}

  input[type="range"]{-webkit-appearance:none; appearance:none; background:transparent; cursor:pointer}
  input[type="range"]::-webkit-slider-track{background:var(--line); height:6px; border-radius:4px}
  input[type="range"]::-webkit-slider-thumb{-webkit-appearance:none; appearance:none; width:18px; height:18px; border-radius:50%; background:var(--rs-blue); box-shadow:0 1px 3px rgba(0,0,0,.25); margin-top:-6px; transition:.2s}
  input[type="range"]:hover::-webkit-slider-thumb{transform:scale(1.1)}
  .range-value{display:inline-block; padding:2px 8px; border-radius:6px; background:#E8F1FA; color:var(--rs-blue); font-weight:700; font-size:13px; margin-left:8px}

  .calcout{display:grid; gap:10px}
  .kpi{display:flex; justify-content:space-between; align-items:center; padding:14px 16px; border:1px solid var(--line); border-radius:10px; background:#fff; transition:box-shadow .2s}
  .kpi:hover{box-shadow:var(--shadow)}
  .kpi strong{font-size:20px; color:var(--rs-blue)}
  .kpi.highlight{background:#F4F8FD; border-color:#DCE6F2}

  /* ===== Таймлайн ===== */
  .timeline{position:relative; padding-left:36px}
  .timeline::before{content:''; position:absolute; left:14px; top:0; bottom:0; width:2px; background:var(--rs-blue)}
  .timeline-item{position:relative; padding-bottom:28px; opacity:0; transform:translateX(-12px); transition:all .45s var(--ease)}
  .timeline-item._in{opacity:1; transform:translateX(0)}
  .timeline-item:last-child{padding-bottom:0}
  .timeline-dot{position:absolute; left:-22px; top:8px; width:14px; height:14px; border-radius:50%; background:var(--rs-blue); border:3px solid #fff; box-shadow:0 0 0 3px rgba(0,75,135,.18)}
  .timeline-content{background:#fff; border:1px solid var(--line); border-radius:var(--radius); padding:16px; box-shadow:var(--shadow)}
  .timeline-title{font-weight:800; color:var(--ink); margin-bottom:4px}
  .timeline-desc{color:var(--ink-soft)}

  /* ===== FAQ ===== */
  details{border:1px solid var(--line); border-radius:10px; background:#fff; box-shadow:var(--shadow); margin-bottom:12px; transition:box-shadow .2s}
  details:hover{box-shadow:var(--shadow-hover)}
  summary{cursor:pointer; list-style:none; padding:14px 16px; font-weight:800; display:flex; justify-content:space-between; align-items:center}
  summary::after{content:'+'; font-size:18px; color:var(--rs-blue); transition:.2s transform}
  details[open] summary::after{transform:rotate(45deg)}
  details[open] summary{border-bottom:1px solid var(--line)}
  details .ans{padding:14px 16px; color:var(--ink); line-height:1.6}

  /* ===== Форма ===== */
  form{display:grid; gap:14px}
  .formgrid{display:grid; grid-template-columns:repeat(2,1fr); gap:14px}
  textarea.input{min-height:120px; resize:vertical}
  .consent{display:flex; gap:10px; align-items:flex-start; color:var(--ink-soft); font-size:14px; line-height:1.45}
  .checkbox{width:18px; height:18px; border-radius:4px; border:2px solid var(--line); background:#fff; appearance:none; cursor:pointer; transition:.2s; flex:0 0 18px; margin-top:1px}
  .checkbox:checked{background:var(--rs-blue); border-color:var(--rs-blue)}
  .checkbox:checked::after{content:'✓'; color:#fff; display:block; text-align:center; line-height:14px; font-weight:800}

  /* ===== Галерея ===== */
  .gallery{display:grid; grid-template-columns:repeat(4,1fr); gap:14px; margin:18px 0}
  .gallery-item{border-radius:10px; overflow:hidden; cursor:pointer; transition:transform .2s, box-shadow .2s; position:relative; aspect-ratio:4/3; border:1px solid var(--line)}
  .gallery-item:hover{transform:translateY(-2px); box-shadow:var(--shadow-hover)}
  .gallery-item::after{content:''; position:absolute; inset:0; background:linear-gradient(180deg,transparent 50%,rgba(0,0,0,.55)); opacity:0; transition:.2s}
  .gallery-item:hover::after{opacity:1}

  /* ===== Футер ===== */
  footer{padding:32px 20px 48px; border-top:1px solid var(--line); background:#fff}
  .foot{max-width:var(--maxw); margin:0 auto; display:grid; gap:18px}
  .foot-bottom{display:flex; justify-content:space-between; align-items:center; gap:16px; flex-wrap:wrap; color:var(--muted); font-size:14px}
  .social{display:flex; gap:10px}
  .social a{width:34px; height:34px; border-radius:50%; background:#EFF4FA; color:var(--rs-blue); display:grid; place-items:center; transition:.2s}
  .social a:hover{background:var(--rs-blue); color:#fff}

  /* ===== Мобильная панель ===== */
  .mbar{display:none; position:fixed; left:0; right:0; bottom:0; z-index:1001; background:#fff; border-top:1px solid var(--line); padding:8px 12px; display:flex; justify-content:space-around; gap:8px; box-shadow:0 -4px 18px rgba(0,0,0,.06)}
  .mbar a{flex:1; text-align:center; padding:8px 6px; border-radius:10px; font-weight:700; font-size:14px; display:flex; flex-direction:column; align-items:center; gap:4px; color:var(--ink)}
  .mbar a.active{color:var(--rs-blue)}

  /* Плавающая кнопка */
  .floating-cta{position:fixed; right:18px; bottom:90px; z-index:1001; box-shadow:var(--shadow-hover); padding:12px 20px}

  /* Спиннер */
  .spinner{display:inline-block; width:18px; height:18px; border:2px solid var(--line); border-radius:50%; border-top-color:var(--rs-blue); animation:spin .6s linear infinite}
  @keyframes spin{to{transform:rotate(360deg)}}

  /* ===== Мобильная адаптация ===== */
  @media (max-width:980px){
    .hero .wrap{grid-template-columns:1fr; gap:24px}
    .illus{order:-1; width:min(380px,90%)}
    .hero-cards{grid-template-columns:1fr}
    .grid.cols-3{grid-template-columns:1fr 1fr}
    .calc{grid-template-columns:1fr}
    .gallery{grid-template-columns:repeat(2,1fr)}
  }
  @media (max-width:640px){
    .menu-toggle{display:block}
    .navlinks{
      position:fixed; top:0; left:-100%; width:100%; height:100vh;
      background:#fff; flex-direction:column; justify-content:center; gap:22px; padding:40px; transition:.35s left var(--ease); z-index:1050;
    }
    .navlinks.active{left:0}
    .navlinks a{font-size:20px; font-weight:800}
    section{padding:38px 16px}
    h1{font-size:clamp(26px,7vw,38px)}
    h2{font-size:clamp(22px,6vw,30px)}
    .grid.cols-3,.grid.cols-2{grid-template-columns:1fr}
    .formgrid{grid-template-columns:1fr}
    .tabs{padding:4px}
    .tab{padding:9px 14px; font-size:14px}
    .mbar{display:flex}
    .floating-cta{display:none}
    .timeline{padding-left:26px}
    .timeline::before{left:10px}
    .timeline-dot{left:-18px; width:12px; height:12px}
  }

  /* Печать */
  @media print{
    header,.navlinks,.mbar,.ghost,.floating-cta,.illus,.wave,.controls-only,.menu-toggle,.social{display:none !important}
    body{background:#fff}
    section{padding:20px 0}
    .card{box-shadow:none; border-color:var(--line-strong)}
    h1,h2,.price{color:var(--rs-blue) !important}
  }
</style>
</head>
<body>

<div class="scrollbar" id="scrollbar"></div>

<!-- ===== Верхняя служебная полоса ===== -->
<div class="topbar">
  <div class="wrap">
    <div>Горячая линия: <strong>8 800 220 0 220</strong></div>
    <div style="display:flex;gap:16px;align-items:center;flex-wrap:wrap">
      <a href="https://rosseti-kuban.ru/online/" target="_blank" rel="noopener">Интернет-приёмная</a>
      <span style="opacity:.7">|</span>
      <a href="https://lk.rosseti-kuban.ru/" target="_blank" rel="noopener">Личный кабинет</a>
    </div>
  </div>
</div>

<!-- ===== Header ===== -->
<header>
  <nav class="nav">
    <div class="logo">
      <div class="mark" aria-hidden="true"></div>
      <div class="brand">
        <div>АО «Россети Кубань»</div>
        <small>Нетарифные услуги</small>
      </div>
    </div>

    <button class="menu-toggle" id="menuToggle" aria-label="Меню">
      <span></span><span></span><span></span>
    </button>

    <div class="navlinks" id="navLinks">
      <a href="#packs">Комплекты</a>
      <a href="#calc">Калькулятор</a>
      <a href="#process">Процесс</a>
      <a href="#gallery">Примеры</a>
      <a href="#faq">FAQ</a>
      <a href="#lead" class="cta">Оставить заявку</a>
    </div>

    <div style="display:flex; gap:8px" class="desktop-actions">
      <button class="ghost" id="btnPrint" type="button">📄 Печать</button>
      <a class="cta" href="#lead">Заявка</a>
    </div>
  </nav>
</header>

<!-- ===== Hero ===== -->
<div class="hero">
  <div class="wrap">
    <div>
      <span class="eyebrow">☀️ Солнечная микрогенерация • Комплекты под ключ</span>
      <h1>Сетевые, гибридные и СБП-решения от <span style="color:var(--rs-blue)">Россети</span></h1>
      <p class="lead">Полный цикл услуг: проектирование, оборудование Хевел, техприсоединение, монтаж и ввод в эксплуатацию. Официальная гарантия, профессиональный сервис.</p>

      <div class="hero-cards">
        <div class="stat">
          <div class="icon">⚡</div>
          <div>
            <div class="label">Сетевые комплекты</div>
            <strong>от 226 090 ₽</strong>
          </div>
        </div>
        <div class="stat">
          <div class="icon">🔋</div>
          <div>
            <div class="label">Гибридные комплекты</div>
            <strong>от 430 290 ₽</strong>
          </div>
        </div>
        <div class="stat">
          <div class="icon">🏠</div>
          <div>
            <div class="label">СБП-системы</div>
            <strong>от 308 690 ₽</strong>
          </div>
        </div>
      </div>

      <div style="display:flex; gap:10px; margin-top:18px; flex-wrap:wrap">
        <a class="cta" href="#packs">🔍 Смотреть комплекты</a>
        <a class="ghost" href="#calc">💰 Рассчитать проект</a>
      </div>
    </div>

    <div class="illus">
      <div class="solar-panel">
        <div class="solar-cell"></div><div class="solar-cell"></div><div class="solar-cell"></div><div class="solar-cell"></div><div class="solar-cell"></div>
        <div class="solar-cell"></div><div class="solar-cell"></div><div class="solar-cell"></div><div class="solar-cell"></div><div class="solar-cell"></div>
        <div class="solar-cell"></div><div class="solar-cell"></div><div class="solar-cell"></div><div class="solar-cell"></div><div class="solar-cell"></div>
      </div>
    </div>
  </div>
</div>

<!-- ===== Преимущества ===== -->
<section>
  <h2>Почему выбирают Россети</h2>
  <p class="sub">Мы не просто сетевая компания — мы ваш технологический партнёр в энергетике будущего</p>

  <div class="grid cols-3">
    <div class="card benefit">
      <div class="icon">🎯</div>
      <div><h3>Единое окно</h3><p>Один договор на всё: от проекта до ввода в эксплуатацию. Никакой бюрократии.</p></div>
    </div>
    <div class="card benefit">
      <div class="icon">⚡</div>
      <div><h3>Гарантия подключения</h3><p>Мы владеем сетями — гарантируем техприсоединение и корректный учёт электроэнергии.</p></div>
    </div>
    <div class="card benefit">
      <div class="icon">🛡️</div>
      <div><h3>Официальная гарантия</h3><p>5 лет на оборудование, 2 года на монтаж. Сервисное обслуживание от производителя.</p></div>
    </div>
    <div class="card benefit">
      <div class="icon">📊</div>
      <div><h3>Прозрачный учёт</h3><p>Двунаправленные счётчики, личный кабинет, автоматическая передача данных в сбыт.</p></div>
    </div>
    <div class="card benefit">
      <div class="icon">🚀</div>
      <div><h3>Быстрая реализация</h3><p>От заявки до запуска — 45 дней. Чёткие сроки на каждом этапе работ.</p></div>
    </div>
    <div class="card benefit">
      <div class="icon">🌱</div>
      <div><h3>Зелёная энергия</h3><p>Снижайте углеродный след, получайте зелёные сертификаты, продавайте излишки в сеть.</p></div>
    </div>
  </div>
</section>

<!-- ===== Комплекты ===== -->
<section id="packs">
  <h2>Готовые комплектные решения</h2>
  <p class="sub">Проверенное оборудование от российского производителя Хевел. Цены указаны без учёта монтажа.</p>

  <div class="tabs">
    <button class="tab active" data-tab="setev">⚡ Сетевые СЭС</button>
    <button class="tab" data-tab="gibrid">🔋 Гибридные СЭС</button>
    <button class="tab" data-tab="sbp">🏠 Системы БП</button>
  </div>

  <div class="grid cols-3" id="cards"></div>
</section>

<!-- ===== Калькулятор ===== -->
<section id="calc">
  <h2>Калькулятор солнечной электростанции</h2>
  <p class="sub">Рассчитайте стоимость проекта «под ключ» и срок окупаемости для вашего объекта</p>

  <div class="calc card">
    <div class="controls-only">
      <div class="field">
        <label for="cat">🏷️ Тип системы</label>
        <select id="cat" class="input">
          <option value="setev">Сетевая СЭС (продажа в сеть)</option>
          <option value="gibrid">Гибридная СЭС (с накопителем)</option>
          <option value="sbp">Система БП (резервное питание)</option>
        </select>
      </div>

      <div class="field">
        <label for="option">⚡ Комплектация</label>
        <select id="option" class="input"></select>
      </div>

      <div class="field">
        <label>
          <input type="checkbox" id="add_proj" class="checkbox" checked>
          📐 Проект и техприсоединение
          <span class="range-value" style="background:#EEF6FF;color:#1e3a8a">ℹ️</span>
        </label>
        <input id="proj_cost" class="input" type="number" step="1000" value="45000" placeholder="Стоимость проекта">
      </div>

      <div class="field">
        <label for="mont_perc">🔧 Монтаж и материалы <span class="range-value" id="mont_val">15%</span></label>
        <input id="mont_perc" type="range" min="10" max="25" step="1" value="15">
      </div>

      <div class="field">
        <label for="dist">📏 Расстояние до точки подключения <span class="range-value" id="dist_val">15 м</span></label>
        <input id="dist" type="range" min="0" max="100" step="5" value="15">
      </div>

      <div class="field">
        <label for="tariff">💰 Ваш тариф, ₽/кВт·ч</label>
        <input id="tariff" class="input" type="number" step="0.1" value="6.0" placeholder="Тариф на электроэнергию">
      </div>

      <div class="field">
        <label for="specgen">☀️ Солнечная активность</label>
        <select id="specgen" class="input">
          <option value="1100">Северные регионы (1100 кВт·ч/кВт·год)</option>
          <option value="1300" selected>Краснодарский край (1300 кВт·ч/кВт·год)</option>
          <option value="1400">Южные регионы (1400 кВт·ч/кВт·год)</option>
        </select>
      </div>
    </div>

    <div class="calcout">
      <div class="kpi"><div>📦 Оборудование</div><strong id="equip">— ₽</strong></div>
      <div class="kpi"><div>📐 Проект и ТП</div><strong id="proj">— ₽</strong></div>
      <div class="kpi"><div>🔧 Монтаж</div><strong id="mont">— ₽</strong></div>
      <div class="kpi highlight"><div>💵 Итого под ключ</div><strong id="sum">— ₽</strong></div>
      <div class="kpi"><div>⚡ Годовая выработка</div><strong id="gen">— кВт·ч</strong></div>
      <div class="kpi"><div>💰 Экономия в год</div><strong id="save">— ₽/год</strong></div>
      <div class="kpi highlight"><div>⏱️ Окупаемость</div><strong id="pp">— лет</strong></div>

      <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top:12px">
        <a class="cta" href="#lead">📞 Получить точный расчёт</a>
        <button class="ghost" type="button" onclick="window.print()">🖨️ Распечатать</button>
      </div>
    </div>
  </div>
</section>

<!-- ===== Процесс ===== -->
<section id="process">
  <h2>Как мы работаем</h2>
  <p class="sub">Прозрачный процесс с контролем на каждом этапе. Средний срок реализации — 45 дней.</p>

  <div class="timeline">
    <div class="timeline-item">
      <div class="timeline-dot"></div>
      <div class="timeline-content">
        <div class="timeline-title">📋 Заявка и консультация</div>
        <div class="timeline-desc">Заполните форму или позвоните. Инженер проконсультирует по мощности и комплектации для вашего объекта.</div>
      </div>
    </div>
    <div class="timeline-item">
      <div class="timeline-dot"></div>
      <div class="timeline-content">
        <div class="timeline-title">📐 Проектирование</div>
        <div class="timeline-desc">Выезд на объект, проект электроснабжения, согласование в Россети, выпуск технических условий.</div>
      </div>
    </div>
    <div class="timeline-item">
      <div class="timeline-dot"></div>
      <div class="timeline-content">
        <div class="timeline-title">📦 Поставка оборудования</div>
        <div class="timeline-desc">Панели Хевел, инверторы, АКБ (для гибридных), крепления, кабели, защитная автоматика.</div>
      </div>
    </div>
    <div class="timeline-item">
      <div class="timeline-dot"></div>
      <div class="timeline-content">
        <div class="timeline-title">🔧 Монтаж и подключение</div>
        <div class="timeline-desc">Установка панелей, сборка щита управления, прокладка кабелей, установка двунаправленного счётчика.</div>
      </div>
    </div>
    <div class="timeline-item">
      <div class="timeline-dot"></div>
      <div class="timeline-content">
        <div class="timeline-title">✅ Ввод в эксплуатацию</div>
        <div class="timeline-desc">Пусконаладка, проверка работы, подключение к личному кабинету, передача данных в энергосбыт.</div>
      </div>
    </div>
    <div class="timeline-item">
      <div class="timeline-dot"></div>
      <div class="timeline-content">
        <div class="timeline-title">🛡️ Гарантия и сервис</div>
        <div class="timeline-desc">Гарантийное обслуживание, удалённый мониторинг, консультации по продаже излишков электроэнергии.</div>
      </div>
    </div>
  </div>
</section>

<!-- ===== Галерея ===== -->
<section id="gallery">
  <h2>Примеры реализованных проектов</h2>
  <p class="sub">Более 500 объектов по Краснодарскому краю: частные дома, фермы, предприятия</p>

  <div class="gallery">
    <div class="gallery-item">
      <img src="data:image/svg+xml,%3Csvg width='400' height='300' xmlns='http://www.w3.org/2000/svg'%3E%3Crect width='400' height='300' fill='%23eef4fb'/%3E%3Ctext x='50%25' y='50%25' text-anchor='middle' dy='.3em' fill='%23004B87' font-family='sans-serif' font-size='18' font-weight='bold'%3EЧастный дом 10 кВт%3C/text%3E%3C/svg%3E" alt="Частный дом">
    </div>
    <div class="gallery-item">
      <img src="data:image/svg+xml,%3Csvg width='400' height='300' xmlns='http://www.w3.org/2000/svg'%3E%3Crect width='400' height='300' fill='%23eaf7f1'/%3E%3Ctext x='50%25' y='50%25' text-anchor='middle' dy='.3em' fill='%23004B87' font-family='sans-serif' font-size='18' font-weight='bold'%3EФермерское хозяйство 25 кВт%3C/text%3E%3C/svg%3E" alt="Ферма">
    </div>
    <div class="gallery-item">
      <img src="data:image/svg+xml,%3Csvg width='400' height='300' xmlns='http://www.w3.org/2000/svg'%3E%3Crect width='400' height='300' fill='%23fff4e6'/%3E%3Ctext x='50%25' y='50%25' text-anchor='middle' dy='.3em' fill='%23004B87' font-family='sans-serif' font-size='18' font-weight='bold'%3EТорговый центр 50 кВт%3C/text%3E%3C/svg%3E" alt="ТЦ">
    </div>
    <div class="gallery-item">
      <img src="data:image/svg+xml,%3Csvg width='400' height='300' xmlns='http://www.w3.org/2000/svg'%3E%3Crect width='400' height='300' fill='%23f0ecff'/%3E%3Ctext x='50%25' y='50%25' text-anchor='middle' dy='.3em' fill='%23004B87' font-family='sans-serif' font-size='18' font-weight='bold'%3EПроизводство 100 кВт%3C/text%3E%3C/svg%3E" alt="Производство">
    </div>
  </div>
</section>

<!-- ===== FAQ ===== -->
<section id="faq">
  <h2>Частые вопросы</h2>
  <div class="grid cols-2">
    <details open>
      <summary>Нужно ли разрешение на установку солнечных панелей?</summary>
      <div class="ans">Для микрогенерации до 15 кВт разрешения не требуется. Мы берём на себя все согласования с сетевой компанией и выпуск технических условий. Вам нужно только подписать документы.</div>
    </details>
    <details>
      <summary>Можно ли продавать электроэнергию в сеть?</summary>
      <div class="ans">Да, по закону о микрогенерации излишки выкупаются гарантирующим поставщиком по средневзвешенной цене оптового рынка. Мы настроим двунаправленный учёт и подключим к системе продаж.</div>
    </details>
    <details>
      <summary>Какая гарантия на оборудование?</summary>
      <div class="ans">На солнечные панели Хевел — 5 лет официальной гарантии + 25 лет на сохранение 80% мощности. На инверторы — 5 лет. На АКБ — 3–5 лет в зависимости от типа. На монтаж — 2 года.</div>
    </details>
    <details>
      <summary>Работают ли панели зимой и в пасмурную погоду?</summary>
      <div class="ans">Да, современные панели работают и в облачную погоду, хотя и с меньшей эффективностью (20–50% от номинала). Зимой выработка снижается, но холод повышает КПД панелей.</div>
    </details>
    <details>
      <summary>Нужно ли обслуживание?</summary>
      <div class="ans">Минимальное: очистка от снега зимой и от пыли 1–2 раза в год. Мы предлагаем сервисные контракты с удалённым мониторингом и выездом специалистов.</div>
    </details>
    <details>
      <summary>Что входит в базовый монтаж?</summary>
      <div class="ans">Опоры, монтаж панелей, прокладка DC/AC кабелей, сборка щита, настройка инвертора, заземление.</div>
    </details>
  </div>
</section>

<!-- ===== CTA ===== -->
<section style="background:#F4F8FD; border-top:1px solid var(--line); border-bottom:1px solid var(--line);">
  <div style="max-width:var(--maxw); margin:0 auto; padding:28px 20px; text-align:center">
    <h2>Готовы перейти на солнечную энергию?</h2>
    <p class="sub">Получите бесплатный расчёт для вашего объекта и узнайте точный срок окупаемости</p>
    <a class="cta" href="#lead" style="font-size:16px; padding:14px 28px">☀️ Рассчитать мою экономию</a>
  </div>
</section>

<!-- ===== Форма ===== -->
<section id="lead">
  <h2>Оставьте заявку на расчёт</h2>
  <p class="sub">Наш инженер свяжется с вами в течение 2 часов в рабочее время</p>

  <div class="card">
    <form id="leadForm">
      <div class="formgrid">
        <div class="field"><label>👤 Ваше имя</label><input class="input" name="name" placeholder="Иван Иванов" required></div>
        <div class="field"><label>📱 Телефон</label><input class="input" name="phone" type="tel" placeholder="+7 (9XX) XXX-XX-XX" required></div>
      </div>
      <div class="formgrid">
        <div class="field"><label>📧 Email</label><input class="input" name="email" type="email" placeholder="ivan@example.com"></div>
        <div class="field"><label>🏷️ Интересующий комплект</label>
          <select class="input" name="pack">
            <option>Выберите тип системы</option><option>Сетевая СЭС</option><option>Гибридная СЭС</option><option>Система БП</option>
          </select>
        </div>
      </div>
      <div class="field"><label>📍 Адрес объекта</label><input class="input" name="address" placeholder="г. Краснодар, ул. Солнечная, д. 1"></div>
      <div class="field"><label>💬 Комментарий</label><textarea class="input" name="comment" placeholder="Площадь крыши, среднее потребление, особенности..."></textarea></div>

      <label class="consent"><input type="checkbox" class="checkbox" required>Согласен на обработку персональных данных в соответствии с <a href="#" target="_blank" style="color:var(--rs-blue)">политикой конфиденциальности</a></label>

      <div style="display:flex; gap:10px; flex-wrap:wrap; align-items:center">
        <button class="cta" type="submit"><span class="spinner" style="display:none"></span> 📨 Отправить заявку</button>
        <button class="ghost" type="reset">Очистить форму</button>
        <div id="formMsg" class="muted" style="margin-left:auto"></div>
      </div>
    </form>
  </div>
</section>

<!-- ===== Footer ===== -->
<footer>
  <div class="foot">
    <div class="foot-bottom">
      <div class="logo">
        <div class="mark"></div>
        <div class="brand"><div>АО «Россети Кубань»</div><small>Солнечная микрогенерация</small></div>
      </div>
      <small style="color:var(--muted)">© 2025 АО «Россети Кубань». Все права защищены. Не является публичной офертой.</small>
    </div>
  </div>
</footer>

<!-- Мобильная панель -->
<nav class="mbar" aria-label="Мобильная навигация">
  <a href="#packs"><span class="icon">📦</span><span>Пакеты</span></a>
  <a href="#calc" class="active"><span class="icon">💰</span><span>Расчёт</span></a>
  <a href="#lead"><span class="icon">📞</span><span>Заявка</span></a>
  <a href="#faq"><span class="icon">❓</span><span>FAQ</span></a>
</nav>

<a class="cta floating-cta" href="#lead">💬 Консультация</a>

<script>
  // ====== Конфигурация ======
  const EMAIL_ADDRESSES = ["abusalimov@gmail.ru"]; // добавьте нужные адреса
  const EMAILJS_SERVICE_ID = "YOUR_SERVICE_ID";     // EmailJS Service ID
  const EMAILJS_TEMPLATE_ID = "YOUR_TEMPLATE_ID";   // EmailJS Template ID
  const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycby2D1kkxg6Vdv-1gESfwN9hqhBekC2uzSZp7bqrfIgCU7wZoQULiwjUuLWSqvfNX0w/exec";

  // ====== Прайс-листы ======
  const PRICES = {
    setev: [
      {kw:5,  phase:'1 фаза', price:226090, popular:true},
      {kw:5,  phase:'3 фазы', price:239890},
      {kw:10, phase:'3 фазы', price:391890, popular:true},
      {kw:15, phase:'3 фазы', price:632590, popular:true},
      {kw:25, phase:'3 фазы', price:887990},
      {kw:50, phase:'3 фазы', price:1133790},
      {kw:100,phase:'3 фазы', price:3293690}
    ],
    gibrid: [
      {kw:5,  phase:'1 фаза', akb:5,  price:430290},
      {kw:5,  phase:'1 фаза', akb:10, price:586990, popular:true},
      {kw:8,  phase:'1 фаза', akb:10, price:775590},
      {kw:8,  phase:'1 фаза', akb:15, price:932390, popular:true},
      {kw:12, phase:'3 фазы', akb:10, price:942090},
      {kw:12, phase:'3 фазы', akb:15, price:1082090, popular:true},
      {kw:12, phase:'3 фазы', akb:20, price:1238790},
      {kw:15, phase:'3 фазы', akb:15, price:1296890},
      {kw:15, phase:'3 фазы', akb:20, price:1453590}
    ],
    sbp: [
      {kw:5,  phase:'1 фаза', akb:5,  price:308690, popular:true},
      {kw:5,  phase:'1 фаза', akb:10, price:465390},
      {kw:8,  phase:'1 фаза', akb:10, price:578990, popular:true},
      {kw:8,  phase:'1 фаза', akb:15, price:735690},
      {kw:12, phase:'3 фазы', akb:10, price:630490},
      {kw:12, phase:'3 фазы', akb:15, price:787090, popular:true},
      {kw:12, phase:'3 фазы', akb:20, price:943890},
      {kw:15, phase:'3 фазы', akb:15, price:932590},
      {kw:15, phase:'3 фазы', akb:20, price:1089290}
    ]
  };

  // ====== Хелперы ======
  const $ = s => document.querySelector(s);
  const $$ = s => Array.from(document.querySelectorAll(s));
  const money = n => n.toLocaleString('ru-RU');
  const scrollbar = $('#scrollbar');

  // Прогресс-бар
  function updateScrollProgress() {
    const h = document.documentElement;
    const progress = (h.scrollTop) / (h.scrollHeight - h.clientHeight) * 100;
    scrollbar.style.width = progress + '%';
  }
  window.addEventListener('scroll', updateScrollProgress, {passive:true});
  updateScrollProgress();

  // Плавная прокрутка
  $$('.navlinks a, .mbar a, .floating-cta, a.cta, a.ghost').forEach(link => {
    const href = link.getAttribute('href') || '';
    if (href.startsWith('#') && href.length > 1) {
      link.addEventListener('click', e => {
        e.preventDefault();
        const target = document.querySelector(href);
        if (target) {
          const offset = 80;
          const top = target.offsetTop - offset;
          window.scrollTo({top, behavior:'smooth'});
          $('#navLinks').classList.remove('active');
          $('#menuToggle').classList.remove('active');
        }
      });
    }
  });

  // Мобильное меню
  const menuToggle = $('#menuToggle');
  const navLinks = $('#navLinks');
  menuToggle?.addEventListener('click', () => {
    menuToggle.classList.toggle('active');
    navLinks.classList.toggle('active');
  });

  // Intersection Observer для анимаций
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add('_in');
        observer.unobserve(entry.target);
      }
    });
  }, {threshold: 0.1});
  $$('.card, .stat, .timeline-item').forEach(el => observer.observe(el));

  // Табы и карточки
  const cards = $('#cards');
  const tabs = $$('.tab');
  let activeTab = 'setev';

  function renderCards() {
    const data = PRICES[activeTab];
    const popular = data.filter(r => r.popular).slice(0, 3);
    const items = popular.length >= 3 ? popular : data.slice(0, 3);

    cards.innerHTML = items.map((r, i) => {
      const type = activeTab === 'setev' ? 'Сетевая СЭС' : activeTab === 'gibrid' ? 'Гибридная СЭС' : 'Система БП';
      const icon = activeTab === 'setev' ? '⚡' : activeTab === 'gibrid' ? '🔋' : '🏠';
      return `
        <div class="card pack">
          ${r.popular ? '<div class="badge">Популярный выбор</div>' : `<div class="badge" style="background:#2E6FA3"> ${type} </div>`}
          <div class="title">${icon} ${r.kw} кВт • ${r.phase}${r.akb ? ` • АКБ ${r.akb} кВт·ч` : ''}</div>
          <div class="price">${money(r.price)} ₽</div>
          <ul class="list">
            <li><div class="check">✓</div><div>${activeTab !== 'sbp' ? 'Солнечные панели Хевел' : 'Инвертор и АКБ'}</div></li>
            <li><div class="check">✓</div><div>${activeTab === 'setev' ? 'Сетевой инвертор' : activeTab === 'gibrid' ? 'Гибридный инвертор' : 'Источник бесперебойного питания'}</div></li>
            <li><div class="check">✓</div><div>Кабели и защитная автоматика</div></li>
            ${r.akb ? '<li><div class="check">✓</div><div>Литиевые аккумуляторы</div></li>' : ''}
          </ul>

          <details ${i === 0 ? 'open' : ''}>
            <summary>Все комплектации ${type}</summary>
            <div class="ans">
              <table style="width:100%; font-size:14px; margin-top:10px; border-collapse:collapse">
                <thead>
                  <tr style="border-bottom:1px solid var(--line); background:#F7F9FC">
                    <th style="padding:8px; text-align:left">Мощность</th>
                    <th style="padding:8px; text-align:left">Фазность</th>
                    ${activeTab !== 'setev' ? '<th style="padding:8px; text-align:left">АКБ</th>' : ''}
                    <th style="padding:8px; text-align:right">Цена</th>
                  </tr>
                </thead>
                <tbody>
                  ${PRICES[activeTab].map(x => `
                    <tr style="border-bottom:1px solid var(--line)">
                      <td style="padding:8px">${x.kw} кВт</td>
                      <td style="padding:8px">${x.phase}</td>
                      ${activeTab !== 'setev' ? `<td style="padding:8px">${x.akb} кВт·ч</td>` : ''}
                      <td style="padding:8px; text-align:right; font-weight:700">${money(x.price)} ₽</td>
                    </tr>
                  `).join('')}
                </tbody>
              </table>
            </div>
          </details>

          <div class="actions" style="margin-top:12px; display:flex; gap:10px">
            <a class="cta" href="#calc" data-cat="${activeTab}" data-idx="${i}">💰 Рассчитать проект</a>
            <a class="ghost" href="#lead">📞 Заказать</a>
          </div>

          <div class="note" style="margin-top:10px; font-size:13px; color:var(--muted)">* Цена без монтажа, опорных конструкций и автоматических выключателей</div>
        </div>
      `;
    }).join('');

    $$('a[data-cat]').forEach(btn => {
      btn.addEventListener('click', () => {
        const cat = btn.getAttribute('data-cat');
        const idx = btn.getAttribute('data-idx');
        $('#cat').value = cat;
        populateOptions();
        if (idx !== null) $('#option').value = idx;
        estimate();
      });
    });

    $$('.card.pack').forEach(el => { el.classList.remove('_in'); observer.observe(el); });
  }
  tabs.forEach(tab => tab.addEventListener('click', () => {
    tabs.forEach(t => t.classList.remove('active'));
    tab.classList.add('active');
    activeTab = tab.getAttribute('data-tab');
    renderCards();
  }));
  renderCards();

  // ====== Калькулятор ======
  const controls = {
    cat: $('#cat'),
    option: $('#option'),
    addProj: $('#add_proj'),
    projCost: $('#proj_cost'),
    montPerc: $('#mont_perc'),
    dist: $('#dist'),
    tariff: $('#tariff'),
    specgen: $('#specgen')
  };
  const outputs = {
    equip: $('#equip'), proj: $('#proj'), mont: $('#mont'), sum: $('#sum'),
    gen: $('#gen'), save: $('#save'), pp: $('#pp')
  };

  // Обновление ярлыков слайдеров
  $('#mont_perc').addEventListener('input', e => { $('#mont_val').textContent = e.target.value + '%'; });
  $('#dist').addEventListener('input', e => { $('#dist_val').textContent = e.target.value + ' м'; });

  function populateOptions() {
    const cat = controls.cat.value;
    const arr = PRICES[cat] || [];
    controls.option.innerHTML = arr.map((r, i) => {
      const label = cat === 'setev'
        ? `${r.kw} кВт • ${r.phase} — ${money(r.price)} ₽`
        : `${r.kw} кВт • ${r.phase} • АКБ ${r.akb} кВт·ч — ${money(r.price)} ₽`;
      return `<option value="${i}">${label}</option>`;
    }).join('');
    controls.montPerc.value = cat === 'setev' ? 15 : 18;
    $('#mont_val').textContent = controls.montPerc.value + '%';
    estimate();
  }

  function estimate() {
    const cat = controls.cat.value;
    const arr = PRICES[cat] || [];
    const idx = parseInt(controls.option.value) || 0;
    const item = arr[idx];
    if (!item) return;

    const equip = item.price;
    const proj = controls.addProj.checked ? Math.max(0, +controls.projCost.value || 0) : 0;
    const montPerc = Math.max(0, +controls.montPerc.value || 0) / 100;
    const dist = Math.max(0, +controls.dist.value || 0);
    const cablePrice = 250; // ₽/м
    const mont = Math.round(equip * montPerc + dist * cablePrice);
    const total = equip + proj + mont;

    outputs.equip.textContent = money(equip) + ' ₽';
    outputs.proj.textContent = money(proj) + ' ₽';
    outputs.mont.textContent = money(mont) + ' ₽';
    outputs.sum.textContent = money(total) + ' ₽';

    const kw = item.kw;
    const specGen = +controls.specgen.value || 1300;
    const yearGen = kw * specGen;
    const tariff = Math.max(1, +controls.tariff.value || 6.0);
    const yearSave = yearGen * tariff;
    const payback = yearSave > 0 ? total / yearSave : 0;

    outputs.gen.textContent = money(Math.round(yearGen)) + ' кВт·ч';
    outputs.save.textContent = money(Math.round(yearSave)) + ' ₽/год';
    outputs.pp.textContent = payback > 0 ? payback.toFixed(1) + ' лет' : '—';

    const config = {
      cat, idx,
      addProj: controls.addProj.checked,
      projCost: +controls.projCost.value,
      montPerc: +controls.montPerc.value,
      dist: +controls.dist.value,
      tariff: +controls.tariff.value,
      specgen: +controls.specgen.value
    };
    localStorage.setItem('solar_calc', JSON.stringify(config));
  }

  Object.values(controls).forEach(control => {
    control.addEventListener('input', estimate);
    control.addEventListener('change', estimate);
  });

  try {
    const saved = JSON.parse(localStorage.getItem('solar_calc') || 'null');
    if (saved) {
      controls.cat.value = saved.cat || 'setev';
      populateOptions();
      controls.option.value = saved.idx || 0;
      controls.addProj.checked = saved.addProj ?? true;
      controls.projCost.value = saved.projCost ?? 45000;
      controls.montPerc.value = saved.montPerc ?? 15;
      controls.dist.value = saved.dist ?? 15;
      controls.tariff.value = saved.tariff ?? 6.0;
      controls.specgen.value = saved.specgen ?? 1300;
      $('#mont_val').textContent = controls.montPerc.value + '%';
      $('#dist_val').textContent = controls.dist.value + ' м';
    } else {
      populateOptions();
    }
  } catch { populateOptions(); }

  // Печать
  $('#btnPrint')?.addEventListener('click', () => window.print());

  // ====== Форма ======
  const form = $('#leadForm');
  const formMsg = $('#formMsg');
  const submitBtn = form.querySelector('button[type="submit"]');
  const spinner = submitBtn.querySelector('.spinner');

  async function sendViaEmailJS(fields) {
    if (!EMAILJS_SERVICE_ID || EMAILJS_SERVICE_ID === "YOUR_SERVICE_ID") throw new Error('EmailJS не настроен');
    const templateParams = {
      to_email: EMAIL_ADDRESSES.join(','),
      from_name: fields.name,
      from_email: fields.email || 'не указан',
      phone: fields.phone,
      address: fields.address || 'не указан',
      pack_type: fields.pack || 'не выбран',
      comment: fields.comment || 'без комментария',
      date: new Date().toLocaleString('ru-RU')
    };
    return emailjs.send(EMAILJS_SERVICE_ID, EMAILJS_TEMPLATE_ID, templateParams);
  }

  async function sendViaGoogleScript(fields) {
    if (!GOOGLE_SCRIPT_URL) throw new Error('Google Script не настроен');
    const data = {
      emails: EMAIL_ADDRESSES,
      subject: 'Заявка: Солнечная микрогенерация',
      name: fields.name, phone: fields.phone, email: fields.email || '',
      address: fields.address || '', pack: fields.pack || '', comment: fields.comment || '',
      date: new Date().toLocaleString('ru-RU')
    };
    await fetch(GOOGLE_SCRIPT_URL, {
      method: 'POST', mode: 'no-cors',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify(data)
    });
    return {ok:true};
  }

  form?.addEventListener('submit', async (e) => {
    e.preventDefault();
    spinner.style.display = 'inline-block';
    submitBtn.disabled = true;
    formMsg.textContent = '';

    const data = new FormData(form);
    const fields = Object.fromEntries(data.entries());

    const message = [
      '☀️ Новая заявка: Солнечная микрогенерация',
      `Имя: ${fields.name || '—'}`,
      `Телефон: ${fields.phone || '—'}`,
      `Email: ${fields.email || '—'}`,
      `Адрес: ${fields.address || '—'}`,
      `Комплект: ${fields.pack || '—'}`,
      `Комментарий: ${fields.comment || '—'}`,
      `Время: ${new Date().toLocaleString('ru-RU')}`
    ].join('\n');

    try{
      if (EMAILJS_SERVICE_ID && EMAILJS_SERVICE_ID !== "YOUR_SERVICE_ID") {
        await sendViaEmailJS(fields);
        formMsg.textContent = '✅ Заявка отправлена на email! Мы свяжемся с вами в ближайшее время.';
        formMsg.style.color = 'var(--ok)';
      } else if (GOOGLE_SCRIPT_URL) {
        await sendViaGoogleScript(fields);
        formMsg.textContent = '✅ Заявка отправлена! Мы свяжемся с вами в ближайшее время.';
        formMsg.style.color = 'var(--ok)';
      } else {
        const subject = 'Заявка: Солнечная микрогенерация';
        const body = encodeURIComponent(message);
        window.location.href = `mailto:${EMAIL_ADDRESSES.join(',')}?subject=${encodeURIComponent(subject)}&body=${body}`;
        formMsg.textContent = '📧 Открываю почтовый клиент для отправки...';
        formMsg.style.color = 'var(--warn)';
      }
      form.reset();
      submitBtn.innerHTML = '✅ Отправлено!';
      setTimeout(()=>submitBtn.innerHTML='📨 Отправить заявку', 3000);
    }catch(err){
      console.error('Ошибка отправки:', err);
      const subject = 'Заявка: Солнечная микрогенерация';
      const body = encodeURIComponent(message);
      window.location.href = `mailto:${EMAIL_ADDRESSES.join(',')}?subject=${encodeURIComponent(subject)}&body=${body}`;
      formMsg.textContent = '📧 Открываю почтовый клиент для отправки...';
      formMsg.style.color = 'var(--warn)';
    } finally{
      spinner.style.display = 'none';
      submitBtn.disabled = false;
    }
  });

  // Активная ссылка в мобильной панели
  const mbarLinks = $$('.mbar a');
  function updateActiveSection() {
    const sections = ['#packs', '#calc', '#lead', '#faq'];
    const scrollPos = window.scrollY + 100;
    sections.forEach((id, idx) => {
      const section = document.querySelector(id);
      if (section) {
        const top = section.offsetTop;
        const height = section.offsetHeight;
        if (scrollPos >= top && scrollPos < top + height) {
          mbarLinks.forEach(link => link.classList.remove('active'));
          if (mbarLinks[idx]) mbarLinks[idx].classList.add('active');
        }
      }
    });
  }
  window.addEventListener('scroll', updateActiveSection, {passive: true});
  updateActiveSection();

  // Метрика (заготовка)
  function trackEvent(action, category='engagement', label=''){
    if (typeof gtag !== 'undefined') gtag('event', action, {event_category:category, event_label:label});
  }
  $$('.cta').forEach(btn => btn.addEventListener('click', ()=>trackEvent('cta_click','conversion',btn.textContent)));
  $('#leadForm')?.addEventListener('submit', ()=>trackEvent('form_submit','conversion','lead_form'));
  tabs.forEach(tab => tab.addEventListener('click', ()=>trackEvent('tab_switch','engagement',tab.textContent)));

  // Доступность
  menuToggle?.addEventListener('click', () => {
    if (navLinks.classList.contains('active')) navLinks.querySelector('a')?.focus();
  });
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && navLinks.classList.contains('active')) {
      navLinks.classList.remove('active'); menuToggle.classList.remove('active'); menuToggle.focus();
    }
  });

  console.log('🌐 Россети Кубань — Солнечная микрогенерация | UI обновлён под корпоративный стиль');
</script>

</body>
</html>
